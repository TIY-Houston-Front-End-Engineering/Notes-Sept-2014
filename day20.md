# Curriculum from today

```js
 ________________________________________
/ Today we talked about REST APIs and    \
| then I introduced the homework for the |
\ weekend                                /
 ----------------------------------------
   \
    \
        .--.
       |o_o |
       |:_/ |
      //   \ \
     (|     | )
    /'\_   _/`\
    \___)=(___/
```

# In simplest terms: What is a database?

It's a spreadsheet.

# What are RESTful API's?

First, a long description: http://stackoverflow.com/questions/671118/what-exactly-is-restful-programming/671132#671132

Now, let's **distill** ths a bit.

For the Github API, there are various **resources**: `users`, `repos`, `teams`, `notifications`, `feeds`, `emojis`, and so forth. These resources are noted mainly here: https://api.github.com/

A resource, like a `person`, is identifiable by a unique attribute. For a `person`, the unique identifier is a `username`, because no one else should also have that `username`. For a `repo`, it is a large number called an `id`.

That unique identifier, like a `username`, is how we interact with a particular instance of `resource`.

When we interact with databases through a RESTful API, we are given a couple options to interact with resources:

1. `GET` the information record of a particular resource
2. `GET` a collection of records for a group of resources
3. `POST` a new JSON object to the server to create a new record of a resource (i.e. a new `person`)
4. `PUT` an updated version of a record on the server, such as update a `person`'s name
5. `DELETE` a record from a resource collection (such as remove a `person` from the database)

These actions (`GET`, `PUT`, `POST`, `DELETE`) are called HTTP verbs, and are accompanied by equivalent jQuery methods `$.get()`, `$.post()`, and `$.ajax()`.

Simply put, RESTful API's exist because it means there is a standardized way for front-end and back-end (browser and server-side code) to talk to each other.

> example RESTful API interaction

![](./examples/day20/1.png)

# JSONP vs JSON

JavaScript in the browser is subject to more security controls. I mentioned that we used Github API because it is CORS-compatible (Cross Origin Resource Sharing), meaning Github lets other sites access it via JavaScript.

Etsy, however, is **not** CORS-compatible. They require us to use JSONP (which is built-in to jQuery. Yay!). JSONP is a JavaScript file generated by the server with data put into it.

Compare these two URLs and what they return (open them in your browser):

1. https://openapi.etsy.com/v2/listings/183182778?api_key=aavnvygu0h5r52qes74x9zvo
2. https://openapi.etsy.com/v2/listings/183182778.js?api_key=aavnvygu0h5r52qes74x9zvo&callback=test

The first one just returns JSON data, the second one returns a js file with a function `test` being called with a large JS object as the argument.

To use JSONP, we need to change the URL to include two things:

1. The URL should point to a '.js' file
2. The URL passed in to `$.get()` should have `&callback=?` at the end.

**Example:**

```js
var api_key = "aavnvygu0h5r52qes74x9zvo";

var etsy_url = [
	"https://openapi.etsy.com/",
	"v2/",
	"listings/",
	"active.js", // <--- added '.js' to the end here, because Etsy provides JSONP this way
	"?",
	"api_key=",
	api_key,
	"&callback=?" // <--- told jQuery to handle the request as JSONP
].join('');

$.getJSON(etsy_url).then(function(data){
	console.log(data);
});
```

# Etsy's REST API and how to use it:

1. Create an app with Etsy here: https://www.etsy.com/developers/documentation/getting_started/register. This will give you an API key to use. Some services use API keys to provide authorization and to rate-limit people who make too many requests (i.e. spam thousands of requests per second).
2. Get your API key from here: https://www.etsy.com/developers/your-apps
3. API's are released with documentation (how to GET/PUT/POST/DELETE them). One resource on Etsy is called a `listing`, and we can learn how to `GET listings` from https://www.etsy.com/developers/documentation/reference/listing
4. Test the REST API resources with your own API key:
	- get all active listings: https://openapi.etsy.com/v2/listings/active?api_key=aavnvygu0h5r52qes74x9zvo
	- look at an individual product on the API: https://openapi.etsy.com/v2/listings/114711047?api_key=aavnvygu0h5r52qes74x9zvo
	- that product has a `user_id` that we can use to find the user's details on the Etsy API: https://openapi.etsy.com/v2/users/19181170?api_key=aavnvygu0h5r52qes74x9zvo
5. Write some code
	```
	var api_key = "aavnvygu0h5r52qes74x9zvo";

	var etsy_url = [
		"https://openapi.etsy.com/",
		"v2/",
		"listings/",
		"active.js",
		"?",
		"api_key=",
		api_key,
		"&callback=?"
	].join();

	$.getJSON(etsy_url).then(function(data){
		console.log(data);
	});
	```

# Homework
```

To be done, polished, and provided on Monday.
- Spend longer than 20 minutes and wrote nothing? Ask someone for help or move on!
- Up past 12:30am? GO TO BED!
- Keep "Do Not Disturb" on while you code. Every distraction costs you ~20min of time. Work in 'sprints'. This is scientifically proven.

 _______
| steps |
 -------
  \
   \
       ___
     {~._.~}
      (   )
     ()~*~()
     (_)-(_)

1) install everything with our lovely setup script
2) in the JS
- write an EtsyClient() constructor
- write methods on the prototype to make requests for
	1. all active listings
	2. an individual listing
	3. a user's data
- write methods on the prototype to edit the DOM
	1. draw active listings
	2. draw individual listing and user info
- create three templates:
	- listings.html - should print HTML for a group of listings
	- listing.html - should print HTML for a single listing
	- user.html - should print HTML about a user


- the EtsyClient(), should load all the listings and display the listings template
- when a listing is clicked, the page should show that single listing's information AND get the user associated with the listing and show that information with the user template

Some setup code:
----------------------

function EtsyClient(options) {
    if (!options.api_key) {
        throw new Error("Yo dawg, I heard you like APIs. Y U NO APIKEY!?!?");
    }
    this.etsy_url = "https://openapi.etsy.com/";
    this.version = options.api_version || "v2/";
    this.api_key = options.api_key;
    this.complete_api_url = this.etsy_url + this.version;
}

EtsyClient.prototype.pullAllActiveListings = function() {
    var model = 'listings';
    var filter = 'active';
    return $.getJSON(this.complete_api_url + model + filter + ".js?api_key=" + this.api_key + "&callback=?").then(function(data) {
        console.log(data);
    });
}

EtsyClient.prototype.getListingInfo = function(id) {
    var model = 'listings';
    return $.getJSON(this.complete_api_url + model + '/' + id + ".js?api_key=" + this.api_key + "&callback=?").then(function(data) {
        console.log(data);
    });
}
```